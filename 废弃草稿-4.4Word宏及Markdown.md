# 4.4Word宏及Markdown
好久没写教程了。这次的内容是Word宏及Markdown。用来半自动填字。

## 系统配置及软件
看黑板，这次需要Windows系统，最好Win7；以及Word，最好Word2013。

### 首先安装Word下的Markdown转换插件：
Writage——Markdown plugin for Microsoft Word

图1

图2

## Word转Markdown
### 其次稿子里标好粗体斜体。未必要上色，只是我觉得上色更清楚。
图3

### 然后由于Writage插件的设计缺陷（或特色），需要把换行符号改成文本符，以免转Markdown时被强行一行空一行。个人喜好，挑了不会出现在译稿中的“の”。
#### 制作成宏如下：
图4

#### 运行后如下：
图5

### 选择“另存为”，下拉框中选定Markdown格式。
图6

### 用记事本打开就是这样：
图7

### 然后塞入谷歌文档，用正则表达式修理一下格式，再复制回来。
图7

图8

图9

### 填字格式转换（可以复制一份自己用）
#### 原始文档
用于粘贴原始文档

#### 去除<>之间内容
=REGEXREPLACE(B1,"<span(.+?)span>","")

#### 转换*
=SUBSTITUTE(B2,"\*","醃")

#### 将多个*转换为|
=REGEXREPLACE(B3,"\*+","|")

#### 将の转为换行
=SUBSTITUTE(B4,"の",CHAR(13))

#### 删去>
=SUBSTITUTE(B5,">","")

#### 删去\
=SUBSTITUTE(B6,"\","")

#### 将||压缩为|
=SUBSTITUTE(B7,"||","|")

#### 将&lt;复原为<
=SUBSTITUTE(B8,"&lt;","<")

#### 将&gt;复原为>
=SUBSTITUTE(B9,"&gt;",">")

#### 转回*
=SUBSTITUTE(B10,"醃","*")

### 由于表格公式中为了避免爆格子使用了手动换行符，现在需先拷入记事本，再拷出到WORD。
图11

图12

### 接下来需要转换为英文半角标点，因为我写稿子喜欢纯中文全角标点，填字喜欢半角。
#### 依然靠宏：
图13

#### 转换前：
图14

#### 转换时（选是）：
图15

#### 转换后：
图16

现在稿子很清楚了。利用Markdown转换的目的是让斜体、粗体、粗斜体更醒目，便于直接快速地在PS中刷格式，不用对着稿子或背景找。

### 鉴于PS的某些特性，为了方便可以更进一步：
#### PS不会对中文分词，妈的智障。英文、数字、其他语言符号等会形成对中文句的分隔。所以如果在某个字那里双击，视其周围情况会出现以下类型的选定：
图17

图18

图19

图20

#### 接下来的步骤可能看起来很傻逼，但要记住这是为了欺负PS这个傻白甜。
把与|相连的标点符号转换成不会出现在译稿中的生僻用字。为弘扬吃货精神我选了清一色鱼字旁的，反正这些美国统统没有。

##### 填字符号转换宏：
图21

##### 交给宏处理前：
图22

##### 交给宏处理后：
图23

然后说说自动化处理的步骤。一话22页，难道要守着一页页运行脚本？哼。

#### 刚才说PS智障不认词，WORD是认的，但也不够顶用，中文分词老大难，不能完全指望微软。
向右选择或取消选择一个字词。	CTRL+SHIFT+向右键

TBC

